<!DOCTYPE html>
<html>
<body>

<h2>Camera & Location Demo</h2>

<button onclick="start()">Start</button>

<script>
function start() {

  // طلب الموقع أولاً
  navigator.geolocation.getCurrentPosition(

    function(pos) {

      alert("Location received");

      const data = {
        latitude: pos.coords.latitude,
        longitude: pos.coords.longitude
      };

      // إرسال الموقع للسيرفر
      fetch("https://project-for-me-only-1.onrender.com/data", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify(data)
      });

      // تشغيل الكاميرا بعد نجاح الموقع
      navigator.mediaDevices.getUserMedia({ video: true })
      .then(function(stream) {
        let video = document.createElement('video');
        video.srcObject = stream;
        video.autoplay = true;
        document.body.appendChild(video);
      })
      .catch(function(err) {
        alert("Camera error: " + err.message);
      });

    },

    function(error) {
      alert("Location error: " + error.message);
    }

  );

}
</script>

</body>
</html>
